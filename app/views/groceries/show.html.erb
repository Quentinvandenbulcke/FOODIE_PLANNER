<div class="container">
  <div class="grocery-recap">
    <h2>You ask the groceries list for :</h2>
    <ul>
      <% @meals.each do |meal| %>
        <li><%= meal.date %> - <%= meal.recipe.name %> (<%= meal.recipe.servings %>pers)</li>
      <% end %>
    </ul>
  </div>
  <div class="grocery-table">
    <div class="grocery-row header-row">
      <div class="grocery-cell">Ingredients</div>
      <div class="grocery-cell grocery-center">Quantity</div>
      <div class="grocery-cell grocery-center">Measure</div>
    </div>

    <% categories = [] %>
    <% @meals.each do |meal| %>
      <% meal.recipe.ingredients.map do |ingredient| %>
        <% categories << ingredient.category %>
      <% end %>
    <% end %>
    <% categories = categories.uniq %>

    <% categories.each do |category| %>
      <div class="grocery-row category-row">
        <%= category %>
      </div>
      <div class="grocery-row">
        <% @lists.each do |list| %>
          <% if list.ingredient.category == category %>
              <div class="grocery-cell"><%= list.ingredient.name %></div>
              <% if list.quantity > 1000 %>
                <div class="grocery-cell grocery-center"><%= (list.quantity / 1000).round(2) %></div>
                <div class="grocery-cell grocery-center">Kilo</div>
              <% else %>
                <div class="grocery-cell grocery-center"><%= list.quantity.ceil %></div>
                <div class="grocery-cell grocery-center"><%= list.ingredient.unit %></div>
              <% end %>
          <% end %>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
